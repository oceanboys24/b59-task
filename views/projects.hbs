<!-- Projects Content -->
<div class="container p-3 w-55 bg-body-secondary mt-5 mb-5 rounded shadow-lg">
  <h2 class="text-center fw-bold">MY PROJECT</h2>
  <div class="row row-cols-4 justify-content-center gap-3">
    <!-- Card Project -->
    {{#each projects}}
      <div class="card col">
        <img src="assets/img/logo.png" class="card-img-top" alt="{{name}}" />
        <div class="card-body">
          <h5 class="card-title">
            <a class="text-decoration-none" href="/detail-project/{{id}}">{{name}}</a>
          </h5>
          <p>Duration: 3 Months</p>
          <div class="overflow-y-auto" style="max-width: 225px; max-height: 98px">
            <p class="card-text">{{description}}</p>
          </div>
          <div class="d-flex mb-3 fs-2">
            {{#each stack}}
              <i class="{{this}}"></i>
            {{/each}}
          </div>
          <div class="d-flex justify-content-between">
            <a href="/project-edit/{{id}}" class="btn btn-primary">Edit</a>
            <!-- Directly passing the ID in onclick -->
            <button class="btn btn-danger" onclick="confirmDelete({{id}})">Delete</button>
          </div>
        </div>
      </div>
    {{/each}}
  </div>
</div>

<script>
  function confirmDelete(projectId) {
    if (confirm("Are you sure you want to delete this project?")) {
      // Proceed with deletion logic
      fetch(`/delete-project/${projectId}`, { 
        method: 'DELETE' 
      })
        .then(response => response.json())  // Parse the response as JSON
        .then(data => {
          if (data.message === 'Project deleted successfully') {
            // Display success message with alert
            alert(data.message);  // Notify the user
            location.reload();  // Reload the page after deletion
          } else {
            alert(data.message || 'Error deleting project.');
          }
        })
        .catch(error => alert("An error occurred: " + error));
    }
  }
</script>
